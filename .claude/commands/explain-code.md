---
name: explain-code
description: 智能分析并解释指定代码的功能、逻辑和实现原理，支持逐行解析。
argument-hint: [代码位置或代码片段]
---

# 参数说明

- **代码位置或代码片段** (必需):
  - 文件路径：如 `src/player_controller.gd:12-45` (指定行数范围)
  - 文件路径：如 `scripts/game_manager.gd` (整个文件)
  - 代码片段：直接粘贴需要分析的代码块
  - 函数名：如 `PlayerController.move_player()` (特定函数)
  - 类名：如 `class PlayerController` (整个类)

# 执行步骤

**当前分析目标**: $ARGUMENTS

## 第一阶段：代码获取与预处理
工具：filesystem

1. 代码输入识别与解析
2. 代码结构预处理

## 第二阶段：深度代码分析
工具：sequential-thinking + memory

1. 代码结构分析
2. 算法逻辑解析
3. 技术实现细节分析

## 第三阶段：多维度解释生成
工具：sequential-thinking + memory

1. 逐行代码解析
2. 功能层面解释
3. 设计思路分析

## 第四阶段：学习指导生成
工具：memory + filesystem

1. 学习要点总结
2. 扩展知识建议

# Agent 与 MCP 工具

## 主要 Agent
- **senior-code-reviewer** (主导): 深度代码分析、逐行解析、技术实现解释
- **general-purpose** (支持): 代码预处理、学习资源搜集、扩展知识整理

## MCP 工具
- **filesystem**: 代码文件读取、结构分析
- **sequential-thinking**: 复杂代码逻辑分析、设计决策解释
- **memory**: 编程知识库查询、最佳实践应用
- **tavily-mcp**: 相关学习资源搜索、技术文档查询

# 交付件

## 主要报告
1. **代码分析报告**: 基本信息、功能概述、结构分析、质量评估
2. **逐行代码解析**: 详细行级解释、变量说明、逻辑分析
3. **技术实现深度解析**: 算法分析、数据结构、性能考虑
4. **学习指导文档**: 关键技术点、学习路径、扩展知识

## 解释结构
```markdown
## 📋 代码功能简述
[1-2句话概括代码的主要功能]

## 🔍 关键实现要点
- **要点1**: [具体说明]
- **要点2**: [具体说明]
- **要点3**: [具体说明]

## 💡 设计思路分析
[分析代码的设计思路和实现选择]

## 📝 使用示例
[提供具体的使用示例]

## ⚠️ 常见问题
[列出常见的问题和解决方案]
```

# 约束条件

## 分析约束
- **可分析长度**: 单次分析代码不超过500行
- **复杂度限制**: 避免分析过于复杂的嵌套逻辑
- **上下文限制**: 缺少完整项目上下文时分析可能不够全面

## 技术约束
- **语言支持**: 支持主流编程语言（GDScript、Python、JavaScript、C++等）
- **框架限制**: 主要支持Godot引擎相关代码
- **静态分析**: 主要进行静态代码分析，无法预测运行时行为

# 使用场景

## 适用场景
- **代码学习**: 帮助初学者理解复杂的代码实现
- **代码审查**: 评估代码的质量和可维护性
- **项目交接**: 为现有代码生成详细的技术文档
- **技术研究**: 深入分析特定技术的实现方式

## 不适用场景
- **运行时调试**: 无法分析和解决运行时错误
- **性能调优**: 不能替代专业的性能分析工具
- **商业评估**: 不评估代码的商业价值和市场前景

# 命令限制说明

此命令专注于代码的理解和分析，不涉及：

- **代码修改**: 不进行具体的代码修改或重构
- **架构设计**: 不进行系统架构的设计和决策
- **项目管理**: 不替代项目管理工具
- **问题解决**: 不直接解决技术问题，使用 `godot-debug` 命令