---
name: godot-gen-doc-reverse
description: 通过分析现有Godot项目代码，逆向推导生成相应的游戏设计文档。
argument-hint: [分析主题]
---

# 参数说明

- **分析主题** (必需): 指定文档生成的主题和范围：
  - **整体项目**: 分析整个项目的完整设计文档
  - **特定模块**: 如 "战斗系统"、"存档系统"、"UI系统" 等
  - **功能范围**: 如 "玩家控制"、"敌人AI"、"关卡机制" 等
  - **技术架构**: 如 "场景架构"、"脚本组织"、"资源管理" 等

# 执行步骤

**当前分析目标**: $ARGUMENTS

## 第一阶段：代码结构深度分析
工具：filesystem + godot + sequential-thinking

1. **项目整体扫描**
   - 递归分析项目的完整文件结构
   - 识别场景文件、脚本文件和资源文件
   - 分析项目的组织架构和模块划分

2. **场景结构解析**
   - 获取项目的场景结构和节点层次
   - 分析场景间的关联和继承关系
   - 识别主要的场景类型和功能分类

3. **代码架构分析**
   - 分析脚本文件的组织结构和依赖关系
   - 识别核心类和功能模块
   - 理解代码的设计模式和编程范式

## 第二阶段：功能实现逆向推导
工具：godot-game-developer + sequential-thinking + memory

1. **核心机制识别**
   - 识别游戏的核心玩法机制
   - 分析玩家交互和控制系统
   - 理解游戏的规则和胜负条件

2. **系统功能解析**
   - 分析各个系统模块的功能实现
   - 理解系统间的交互和数据流
   - 识别关键的算法和数据结构

3. **设计模式推导**
   - 识别代码中使用的设计模式
   - 分析架构决策的设计意图
   - 推导原始的设计思路和理念

## 第三阶段：设计文档生成
工具：design-doc-writer + filesystem + memory

1. **游戏设计文档生成**
   - 生成完整的游戏设计文档(GDD)
   - 包含游戏概述、核心机制、系统设计
   - 添加用户体验和交互设计说明

2. **技术文档整理**
   - 生成技术架构文档和API说明
   - 整理代码规范和开发指南
   - 创建部署和维护文档

# Agent 与 MCP 工具

## 主要 Agent
- **godot-architect** (主导): 架构分析、设计模式识别、技术推导
- **godot-game-developer**: 游戏功能分析、机制推导、实现理解
- **godot-code-reviewer**: 代码质量分析、用户体验评估
- **design-doc-writer**: 文档结构化、内容组织、标准化输出

## MCP 工具
- **filesystem**: 项目文件扫描分析、文档创建
- **godot**: 项目信息获取、场景结构分析、运行测试
- **sequential-thinking**: 复杂架构分析、设计推理、功能逻辑分析
- **memory**: 设计模式识别、知识库建立、最佳实践查询

# 交付件

## 主要文档
1. **逆向生成游戏设计文档**: 完整的GDD，包含游戏概念、核心机制、系统设计、技术架构
2. **技术架构文档**: 详细的技术架构、模块划分、接口定义、数据结构分析
3. **代码实现规范**: 代码风格、开发流程、最佳实践、维护指南
4. **项目交接文档**: 项目背景、技术要点、维护建议、团队信息

## 文档结构
```markdown
# 逆向生成游戏设计文档：[项目名称]

## 1. 游戏概述
### 1.1 游戏概念推导
### 1.2 核心玩法分析
### 1.3 目标受众定位

## 2. 核心机制设计
### 2.1 核心玩法循环
### 2.2 控制系统分析
### 2.3 规则和机制推导

## 3. 系统功能设计
### 3.1 进程系统
### 3.2 战斗/挑战系统
### 3.3 经济/奖励系统

## 4. 用户体验设计
### 4.1 UI/UX分析
### 4.2 交互流程推导

## 5. 技术架构设计
### 5.1 系统架构推导
### 5.2 关键技术分析
### 5.3 性能优化策略
```

# 约束条件

## 分析约束
- **代码完整性**: 分析结果准确性依赖于代码质量和完整性
- **推理准确性**: 逆向推导的设计意图可能存在偏差
- **复杂度限制**: 大型项目分析需要更多时间和资源
- **静态分析限制**: 无法获取完整的运行时信息

## 技术约束
- **标准化**: 生成的文档遵循标准化格式和结构
- **完整性**: 文档完整性依赖于分析深度和广度
- **时效性**: 文档反映分析时的项目状态
- **验证责任**: 用户需要验证生成文档的准确性

## 输出约束
- **禁止输出代码实现**: 只输出设计文档和技术分析
- **禁止详细代码**: 设计文档中可包含代码示例和伪代码
- **设计导向**: 专注于技术设计和架构推导

# 使用场景

## 适用场景
- **项目交接**: 团队变更、项目转让、外包交接、人员离职时的知识交接
- **文档补全**: 原有文档缺失、过时、需要升级或标准化
- **代码重构**: 架构重构前理解现有设计、模块重用、技术迁移
- **学习研究**: 分析优秀项目学习设计技巧、模式研究、架构学习

## 不适用场景
- **新项目设计**: 使用 `godot-game-design` 命令
- **代码实现**: 使用 `godot-gen-code` 命令
- **架构设计**: 使用 `godot-architect` 命令
- **问题调试**: 使用 `godot-debug` 命令