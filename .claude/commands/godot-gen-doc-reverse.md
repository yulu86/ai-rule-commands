---
name: godot-gen-doc-reverse
description: 代码逆向分析生成设计文档
argument-hint: "[分析主题]"
---

## 功能说明

通过分析现有 Godot 项目代码，逆向推导并生成相应的游戏设计文档。该工具适用于代码重构、文档补全和项目交接等场景。

## 执行步骤

1. **参数验证**：
   - 检查用户是否提供了分析主题参数
   - 如未提供参数，提示用户指定需要分析的主题方向

2. **项目信息收集**：
   - @godot-architect 读取项目配置文件 CLAUDE.md，了解项目基本信息和架构
   - 分析项目整体结构、技术栈和开发规范 use context7

3. **Agent协调代码深度分析**：
   - **架构层面分析**: 使用Task工具启动godot-architect代理进行架构分析
     * 根据分析主题 $ARGUMENTS 读取相关代码文件
     * 分析代码的模块结构、设计模式和架构决策
     * 理解代码间的依赖关系和交互机制
     * 推测原始开发者的设计思路和实现目标
   - **实现层面分析**: 根据代码类型启动相应的专业领域agent
     * **游戏逻辑代码**: 启动godot-game-developer分析游戏机制实现
     * **算法密集代码**: 启动senior-code-reviewer进行算法和性能分析
   - **补充分析**: 使用Explore工具进行项目结构分析
     * 梳理整体项目结构和代码组织
     * 识别相关的配置文件和资源文件
     * 理解代码与项目其他部分的关联关系

4. **智能主题归类与文档规划**：
   - **多维度分析整合**: 使用sequential-thinking工具整合所有agent的分析结果
   - **专业文档规划**: 使用Task工具启动design-doc-writer代理进行文档规划
     * 基于代码分析结果确定主题和子主题的具体名称
     * 按照 `文档输出路径` 规范创建相应的目录结构和文件
     * 设计符合技术文档标准的组织结构和内容大纲
   - **技术可行性验证**: 使用godot-architect验证文档规划的技术合理性

5. **Agent协作文档生成与审查**：
   - **主要文档生成**: 使用design-doc-writer基于代码分析结果编写设计文档
     * **功能描述**：详细说明各模块的功能和业务逻辑
     * **架构说明**：解释系统的整体架构和设计思路
     * **实现细节**：描述关键算法、数据结构和实现技术
     * **使用指南**：提供相应的使用、维护和扩展指导
   - **专业审查阶段**: 启动相关agent进行文档质量审查
     * **技术准确性审查**: godot-architect验证架构描述的正确性
     * **实现细节审查**: godot-game-developer验证代码实现的准确性
     * **文档质量审查**: senior-code-reviewer检查文档的完整性和可读性
   - **文档优化**: 根据专业意见进行文档完善和质量提升

6. **质量验证与知识管理**：
   - **代码一致性验证**: 确保文档内容与实际代码实现一致
   - **技术验证**: 使用godot工具验证文档中的技术描述
   - **知识沉淀**: 将逆向分析过程中的发现和经验记录到memory
   - **模式识别**: 提取代码中的优秀设计模式和实现技巧

## 文档组织规范

### 目录结构
```
/docs/
├── {两位数字编号}_{主题}/
│   ├── {两位数字编号}_{子主题}.md
│   ├── {两位数字编号}_{子主题}.md
│   └── ...
```

### 命名规范
- **主题名称**：使用中文，简洁明确地表达文档内容
- **编号规则**：使用两位数字编号，便于排序和引用
- **文件格式**：统一使用 Markdown 格式（.md）

### 文档内容标准
- **结构清晰**：使用标准的 Markdown 语法和层次结构
- **内容完整**：涵盖功能描述、架构设计、实现要点等
- **易于理解**：使用清晰的语言和适当的示例说明