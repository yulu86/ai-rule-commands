---
name: godot-gen-doc
description: Godot 游戏特性设计文档生成器
argument-hint: "[主题|特性] [概要|详细]"
---

## 功能说明

根据指定的主题或特性，智能生成 Godot 游戏设计文档。支持概要设计和详细设计两种模式，适用于新功能规划、系统设计和技术方案文档化。

## 执行步骤

1. **参数验证**：
   - 检查用户是否提供了主题和详细程度参数
   - 参数格式：`[主题/特性名称] [概要/详细]`
   - 如未提供参数，提示用户输入必要信息

2. **项目信息收集**：
   - 使用memory工具查询项目历史信息和设计决策
   - 使用Explore工具快速扫描项目结构，识别相关组件和代码模式
   - 使用filesystem工具读取项目配置文件 CLAUDE.md，掌握项目基本信息
   - 通过godot工具分析现有项目结构和场景组织
   - 使用context7获取相关Godot功能的最新文档和最佳实践
   - 分析项目现有架构和技术栈，确保新设计与项目整体风格一致
   - 如存在相关代码，使用filesystem工具读取现有代码以理解当前实现状态

3. **Agent协调架构设计**：
   - **第一阶段**: 使用Task工具启动godot-architect代理进行专业架构分析
     - 分析主题 $1 的技术架构需求和组件设计
     - 提供多种架构方案和技术选型建议
     - 输出标准化的架构设计文档
   - **第二阶段**: 如果涉及游戏机制设计，并行启动godot-game-designer
     - 设计游戏核心机制和用户体验流程
     - 提供美术风格和交互设计建议
     - 输出游戏设计方案文档

4. **智能方案整合与选择**：
   - 使用sequential-thinking工具深度分析所有agent提供的设计方案
   - 整合架构设计和游戏设计，确保技术可行性和用户体验的平衡
   - 通过tavily-mcp搜索相关的技术趋势和社区最佳实践，优化方案
   - 设计至少两个不同的综合实现方案
   - 使用AskUserQuestion向用户展示方案选项，收集用户偏好

5. **Agent协作文档生成**：
   - **主要文档生成**: 使用Task工具启动多个design-doc-writer代理并行生成专业文档
     - 传递完整的架构设计方案和游戏设计理念
     - 指定文档类型为技术设计文档或游戏设计文档
     - 要求包含所有必需章节和标准化格式
   - **专业审查**: 文档初稿完成后，启动相关agent进行专业审查
     - 技术准确性审查：godot-architect或godot-game-developer
     - 游戏设计合理性审查：godot-game-designer（如适用）
   - **文档优化**: 根据专业意见进行文档完善和质量提升

6. **文档输出与知识管理**：
   - 使用filesystem工具创建文档目录结构并输出最终文档
   - 使用memory工具记录设计决策、agent协作过程和最佳实践
   - 使用Bash命令执行文档格式化和验证
   - 建立文档与相关代码文件的关联关系
   - **概要模式**：专注于功能描述、系统架构、核心流程等高层设计
   - **详细模式**：包含具体的代码设计、接口定义、数据结构等技术细节

## 文档组织规范

### 输出路径
```
/docs/02_特性设计/{两位数字编号}_{特性名称}.md
```

### 文档结构

#### 概要设计文档应包含：
- **功能概述**：特性的核心价值和主要功能点
- **用户场景**：典型的使用场景和用户故事
- **系统架构**：高层次的架构设计和组件关系
- **核心流程**：主要业务流程和交互逻辑
- **技术要点**：关键技术和实现难点分析

#### 详细设计文档应包含：
- **设计背景**：详细的需求分析和设计目标
- **架构设计**：完整的系统架构和模块划分
- **接口设计**：详细的 API 接口和数据结构定义
- **实现方案**：具体的算法设计和代码结构规划
- **性能考虑**：性能优化策略和资源管理方案
- **扩展性设计**：未来的扩展方向和兼容性考虑

### 命名规范
- **文件名**：使用中文命名，如 `01_战斗系统.md`、`02_角色控制.md`
- **编号规则**：使用两位数字编号，便于文档排序和管理