---
name: auto-commit
description: 智能Git自动提交技能，当用户输入"auto commit"、"git commit"、"提交代码"时触发，自动检测代码变更、生成符合规范的commit message并执行提交。使用Bash和sequential-thinking工具进行快速分析和执行，确保高效准确的代码提交工作流。
---

# Git Auto Commit 技能

## 技能概述

自动检测项目中的代码变更，智能生成符合规范的Git提交信息并执行提交操作。专注于速度和准确性，避免任何无关的签名信息。

## 触发条件

当用户输入以下任一指令时触发技能：
- "auto commit"
- "git commit" 
- "提交代码"

## 执行流程

### 1. 快速状态检测
使用 `git status --porcelain` 快速获取所有变更状态，包括：
- 已暂存文件 (staged)
- 未暂存修改 (modified)
- 未跟踪文件 (untracked)

### 2. 自动暂存处理
如果检测到未暂存的变更，自动执行 `git add .` 暂存所有变更文件。

### 3. 智能生成Commit Message

使用 `scripts/auto_commit.py` 脚本分析文件变更并生成提交信息：

**文件类型识别**：
- 根据文件扩展名智能识别文件类型和用途
- 使用中文描述文件变更（如：添加用户认证组件、更新数据库配置）

**操作类型映射**：
- `A` (新增) → "添加/新增"
- `M` (修改) → "更新/修改/优化" 
- `D` (删除) → "删除/清理"
- `R` (重命名) → "重命名"

**批量变更处理**：
- 单文件变更：直接描述具体变更
- 多文件变更：生成汇总性描述
- 按文件类型权重生成主操作描述

### 4. 执行提交
使用生成的commit message执行 `git commit -m "提交信息"`

## 核心脚本使用

### 基本用法
```bash
python scripts/auto_commit.py
```

### 指定提交信息
```bash
python scripts/auto_commit.py "自定义提交信息"
```

### 脚本特性
- **快速执行**：优化Git命令执行，减少IO开销
- **智能分析**：自动识别文件类型和操作类型
- **中文输出**：生成符合中文习惯的提交信息
- **错误处理**：完整的异常处理和用户反馈

## Commit Message规范

参考 [references/commit-patterns.md](references/commit-patterns.md) 了解详细的格式规范：

### 基本格式
```
<动词><描述性内容>
```

### 推荐动词
- **添加类**：添加、新增、引入、实现
- **修改类**：更新、修改、优化、调整、重构、改进  
- **修复类**：修复、解决、完善
- **删除类**：删除、清理、移除
- **文档类**：完善、更新、添加

### 长度限制
- 标题：不超过72字符
- 超长时自动截断处理

## 特殊情况处理

### 无变更场景
当没有检测到任何变更时，返回"没有需要提交的变更"

### 仅格式化变更
对于仅包含代码格式化的变更，使用：
- "代码格式化和清理"
- "调整代码缩进"

### 配置文件变更
批量配置文件变更使用：
- "更新项目配置和设置"

### 大规模重构
使用描述性汇总：
- "代码重构和功能优化，涉及X个文件"

## 工具集成

### Bash命令
使用Bash工具执行Git命令：
- `git status --porcelain` - 获取变更状态
- `git add .` - 暂存所有变更
- `git commit -m "message"` - 执行提交

### Sequential Thinking
使用sequential-thinking工具进行：
- 变更文件分析和分类
- Commit Message生成策略选择
- 异常情况处理决策

## 质量保证

### 避免的内容
- ❌ 工具签名信息（如"🤖 Generated with Claude Code"）
- ❌ Co-authored信息
- ❌ 时间戳和版本号
- ❌ 无意义的描述（"update"、"fix"）

### 提交信息示例
✅ 正确示例：
- "添加用户登录验证功能"
- "修复商品页面响应式布局问题"  
- "更新数据库连接池配置"
- "优化订单查询性能"
- "重构支付模块代码结构"

## 错误处理

### Git仓库检查
确认当前目录是Git仓库，否则提示用户

### 权限问题
处理Git命令执行权限和文件访问权限

### 网络问题
对于需要网络操作的Git命令提供超时处理

### 用户反馈
提供清晰的成功/失败反馈信息

## 技能限制

- 仅支持Git仓库操作
- 需要Git已正确配置用户信息
- 依赖Python环境运行核心脚本
- 不处理合并冲突等复杂Git操作