---
name: code-explainer
description: 智能代码解释分析技能，当用户输入"解释代码"、"explain code"时触发，提供代码功能、实现逻辑和设计意图的深度解析。使用文本、表格和ASCII图等多种形式，结合agents和MCP工具进行代码理解和可视化展示。
---

# 代码解释分析技能

## 技能概述

智能分析代码片段的功能、实现逻辑和设计意图，为开发人员提供清晰、直观的代码理解服务。支持多种编程语言，能够识别特殊代码模式和分支逻辑。

## 触发条件

当用户输入以下任一指令时触发技能：
- "解释代码"
- "explain code"
- "代码分析"
- "代码解读"
- "这段代码是做什么的"

## 执行流程

### 1. 代码获取与识别
使用Glob、Read或Grep工具获取目标代码：
- 支持文件路径指定（如："解释 src/components/Button.tsx"）
- 支持代码片段直接分析
- 支持代码块和函数级别的分析

### 2. 智能代码分析
使用 `scripts/code_analyzer.py` 进行深度分析：

**语言识别**：
- 根据文件扩展名和语法特征识别编程语言
- 支持主流语言：JavaScript/TypeScript、Python、Java、C++、Go、Rust等

**代码结构分析**：
- 函数/方法定义和调用关系
- 类和对象结构
- 模块导入和依赖关系
- 控制流分析（条件分支、循环等）

### 3. 多维度解释生成

#### 3.1 功能概述
- **主要功能**：代码的核心作用和业务目标
- **输入输出**：参数类型、返回值、副作用
- **使用场景**：代码的实际应用环境

#### 3.2 实现逻辑
- **算法分析**：关键算法和数据结构的使用
- **流程描述**：代码执行的具体步骤
- **关键点**：重要的实现细节和技巧

#### 3.3 设计意图
- **架构思路**：代码结构背后的设计理念
- **模式识别**：使用的设计模式和编程范式
- **性能考虑**：性能优化和资源管理策略

#### 3.4 特殊处理说明
- **边界条件**：特殊的分支处理和异常情况
- **错误处理**：错误捕获和处理机制
- **安全考虑**：安全相关的实现和防护措施

### 4. 可视化展示

#### 4.1 文本说明
使用清晰的结构化文本说明：
```markdown
## 功能概述
[简述代码功能]

## 核心逻辑
[详细解释实现过程]

## 设计意图
[分析设计思路]

## 注意事项
[特殊处理和最佳实践]
```

#### 4.2 表格展示（可选）
对于复杂的代码结构使用表格：

| 方法/函数 | 作用 | 参数 | 返回值 | 特殊处理 |
|-----------|------|------|--------|----------|
| validateInput | 验证用户输入 | string | boolean | 长度限制检查 |
| processData | 处理数据 | array | object | 异步处理 |

#### 4.3 ASCII流程图（可选）
使用ASCII字符绘制执行流程：

```
输入数据
    ↓
参数验证 ──→ [无效] → 返回错误
    ↓
数据处理
    ↓
格式化输出
    ↓
返回结果
```

## 核心脚本使用

### 基本用法
```bash
python scripts/code_analyzer.py --file <文件路径>
```

### 代码片段分析
```bash
python scripts/code_analyzer.py --code <代码字符串>
```

### 指定分析深度
```bash
python scripts/code_analyzer.py --file <文件路径> --depth [basic|detailed|comprehensive]
```

### 脚本特性
- **语言支持**：自动识别编程语言和语法
- **智能分析**：基于抽象语法树的深度分析
- **模式匹配**：识别常见的设计模式和编程范式
- **结构化输出**：生成标准化的分析报告

## 分析模板参考

### 函数级分析模板
参考 [references/function-analysis-template.md](references/function-analysis-template.md) 获取标准化的函数分析模板：

#### 基本信息
- 函数签名和参数类型
- 返回值和副作用
- 时间复杂度分析

#### 逻辑流程
- 主要执行步骤
- 条件分支处理
- 异常和边界情况

### 类/模块分析模板
参考 [references/class-analysis-template.md](references/class-analysis-template.md)：

#### 类结构
- 属性和方法
- 继承关系
- 接口实现

#### 设计模式
- 使用的架构模式
- 封装和抽象策略
- 扩展性和维护性

## 工具集成

### 代码读取工具
- **Read**：读取单个文件内容
- **Glob**：批量查找匹配文件
- **Grep**：搜索特定代码模式

### MCP服务器工具
- **sequential-thinking**：进行代码逻辑的逐步推理
- **memory**：存储和检索代码模式和最佳实践
- **tavily-mcp**：查找相关文档和技术资料

### Agents协作
- **senior-code-reviewer**：进行深度代码审查和质量评估
- **software-architect**：分析架构设计和系统整合
- **Explore**：快速定位和理解大型代码库结构

## 解释质量标准

### 准确性要求
- ✅ 准确理解代码功能和逻辑
- ✅ 正确识别语法和语义
- ✅ 精确分析依赖和调用关系

### 清晰性要求
- ✅ 使用简洁明了的语言
- ✅ 结构化展示分析结果
- ✅ 适当的可视化辅助

### 实用性要求
- ✅ 提供实际的开发指导
- ✅ 指出潜在问题和改进点
- ✅ 给出最佳实践建议

## 特殊代码处理

### 复杂算法
- 逐步分析算法思想
- 时间空间复杂度分析
- 优化建议和替代方案

### 异步代码
- 异步流程和并发控制
- 回调和Promise处理
- 错误传播机制

### 框架特定代码
- 框架的生命周期管理
- 组件状态和Props传递
- 路由和导航逻辑

## 错误处理

### 代码解析错误
- 语法错误的识别和报告
- 编码问题的处理
- 文件访问异常

### 分析失败处理
- 不支持的编程语言
- 过于复杂的代码结构
- 缺少上下文信息

### 用户反馈
- 清晰的错误提示
- 建议的解决方法
- 替代分析方案

## 技能限制

- 需要可访问的代码文件或代码片段
- 依赖Python环境运行核心分析脚本
- 对于大型项目可能需要分层分析
- 某些特定领域代码可能需要领域知识补充