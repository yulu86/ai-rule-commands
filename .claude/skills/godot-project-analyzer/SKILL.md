---
name: godot-project-analyzer
description: Godot项目逆向分析专家，专门通过分析现有Godot项目代码来推导游戏设计意图和架构，并生成完整的游戏设计文档。当用户输入"分析项目"、"逆向分析"等关键词且当前目录包含Godot项目文件时触发。适用于项目交接、文档补全、代码重构、学习研究等场景，能够深度分析场景结构、脚本组织、资源管理，并输出标准化的GDD和技术架构文档。
---

# Godot项目逆向分析器

## 概述

该技能使Claude能够通过分析现有Godot项目的代码结构，逆向推导游戏设计意图和架构决策，生成完整的游戏设计文档(GDD)和技术架构文档。

## 核心能力

该技能提供完整的Godot项目逆向分析流程，从代码到设计文档的端到端处理能力：

### 1. 项目检测与验证
自动检测当前目录是否为Godot项目，验证项目结构的完整性和有效性。

### 2. 代码结构深度分析
使用MCP工具进行全面的项目扫描，分析场景文件、脚本文件和资源组织。

### 3. 功能实现逆向推导
通过代码分析推导核心玩法机制、系统设计意图和架构决策。

### 4. 设计文档生成
输出标准化的游戏设计文档、技术架构文档和代码实现规范。

## 分析流程

## 第一阶段：项目检测与初始化

### 触发条件检测
- **用户输入分析**: 检测"分析项目"、"逆向分析"等关键词
- **项目文件检测**: 查找 `.project` 文件、`.tscn` 场景文件、`.gd` 脚本文件
- **项目验证**: 确认项目结构完整，可以进行有效分析

### 分析范围确定
根据用户需求和项目规模确定分析深度：
- **整体项目**: 完整项目的全面分析
- **特定模块**: 指定系统或功能模块的深度分析
- **功能范围**: 特定游戏机制或功能的专项分析

## 第二阶段：代码结构分析

### 项目整体扫描
使用 `mcp__filesystem__directory_tree` 和 `mcp__godot__list_projects` 工具：
```bash
# 递归扫描项目文件结构
mcp__filesystem__directory_tree .

# 列出Godot项目信息
mcp__godot__list_projects .
```

### 场景结构解析
使用 `mcp__godot__get_project_info` 和场景分析工具：
- 分析主场景层次结构
- 识别场景间的关联关系
- 理解节点组织模式

### 代码架构分析
结合 `mcp__sequential-thinking__sequentialthinking` 进行深度分析：
- 脚本依赖关系分析
- 设计模式识别
- 架构决策推导

## 第三阶段：设计意图推导

### 核心机制识别
通过代码分析推导：
- **核心玩法循环**: 识别主要的游戏循环机制
- **玩家控制**: 分析输入处理和控制逻辑
- **游戏规则**: 推导胜负条件和游戏机制

### 系统功能解析
深度分析各个系统模块：
- **进程系统**: 游戏状态管理和进度追踪
- **战斗/挑战系统**: 冲突解决和难度管理
- **经济/奖励系统**: 资源管理和激励机制

### 设计模式推导
识别代码中体现的设计理念：
- **架构模式**: MVC、组件系统、状态机等
- **编程范式**: 面向对象、函数式、事件驱动等
- **优化策略**: 性能优化和内存管理技术

## 第四阶段：文档生成

### 游戏设计文档(GDD)
使用标准文档结构生成完整GDD：

#### 1. 游戏概述
- **游戏概念推导**: 基于代码结构和内容推导游戏概念
- **核心玩法分析**: 通过主要机制推导核心玩法
- **目标受众定位**: 根据复杂度和风格确定目标用户

#### 2. 核心机制设计
- **核心玩法循环**: 详细描述主要的游戏循环
- **控制系统分析**: 输入处理和控制机制
- **规则和机制推导**: 基于代码逻辑推导游戏规则

#### 3. 系统功能设计
- **进程系统**: 玩家进度和成就系统
- **战斗/挑战系统**: 冲突和挑战设计
- **经济/奖励系统**: 资源获取和激励机制

### 技术架构文档
生成详细的技术文档：

#### 系统架构推导
- **整体架构**: 项目的高层架构设计
- **模块划分**: 功能模块的组织和依赖关系
- **接口定义**: 模块间的通信接口

#### 关键技术分析
- **关键技术**: 使用的主要技术和方法
- **算法设计**: 核心算法和数据结构
- **性能优化**: 性能瓶颈和优化策略

### 输出文件命名规范
根据项目要求使用标准文档命名：
- **游戏设计文档**: `01_逆向生成游戏设计文档.md`
- **技术架构文档**: `02_技术架构设计文档.md`
- **实现规范文档**: `03_代码实现规范文档.md`

## 工具与资源

### 主要MCP工具

#### filesystem工具集
- `mcp__filesystem__directory_tree`: 项目文件结构扫描
- `mcp__filesystem__list_directory`: 目录内容分析
- `mcp__filesystem__search_files`: 文件模式搜索
- `mcp__filesystem__read_text_file`: 代码文件读取分析

#### godot工具集
- `mcp__godot__list_projects`: Godot项目识别
- `mcp__godot__get_project_info`: 项目元数据获取
- `mcp__godot__get_godot_version`: Godot版本检测
- `mcp__godot__run_project`: 项目运行测试

#### 思考分析工具
- `mcp__sequential-thinking__sequentialthinking`: 复杂逻辑分析
- `mcp__memory__*`: 知识库建立和管理

### 技能资源

#### references/
- `gdd_template.md`: 游戏设计文档模板和结构
- `godot_patterns.md`: Godot常用设计模式参考
- `analysis_guidelines.md`: 代码分析最佳实践指南

#### scripts/
- `project_detector.py`: Godot项目检测脚本
- `scene_analyzer.py`: 场景结构分析工具
- `dependency_mapper.py`: 代码依赖关系映射工具

#### assets/
- `doc_templates/`: 标准文档模板
- `diagram_templates/`: 架构图和流程图模板

## 约束条件

### 分析约束
- **代码完整性**: 分析结果准确性依赖于代码质量和完整性
- **推理准确性**: 逆向推导的设计意图可能存在偏差
- **复杂度限制**: 大型项目分析需要更多时间和资源
- **静态分析限制**: 无法获取完整的运行时信息

### 技术约束
- **标准化**: 生成的文档遵循标准化格式和结构
- **完整性**: 文档完整性依赖于分析深度和广度
- **时效性**: 文档反映分析时的项目状态
- **验证责任**: 用户需要验证生成文档的准确性

### 输出约束
- **禁止输出代码实现**: 只输出设计文档和技术分析
- **禁止详细代码**: 设计文档中可包含代码示例和伪代码
- **设计导向**: 专注于技术设计和架构推导

## 使用场景

### 适用场景
- **项目交接**: 团队变更、项目转让、外包交接、人员离职时的知识交接
- **文档补全**: 原有文档缺失、过时、需要升级或标准化
- **代码重构**: 架构重构前理解现有设计、模块重用、技术迁移
- **学习研究**: 分析优秀项目学习设计技巧、模式研究、架构学习

### 不适用场景
- **新项目设计**: 使用 `godot-game-design` 命令
- **代码实现**: 使用 `godot-gen-code` 命令
- **架构设计**: 使用 `software-architect-design` 命令
- **问题调试**: 使用 `godot-debug` 命令
